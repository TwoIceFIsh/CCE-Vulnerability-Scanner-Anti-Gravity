import os
import sys

from win32comext.shell import shell


def uac_require():
    ASADMIN = 'asadmin'
    try:
        if sys.argv[-1] != ASADMIN:
            script = os.path.abspath(sys.argv[0])

            params = ' '.join([script] + sys.argv[1:] + [ASADMIN])
            print(sys.executable)
            print(params)
            shell.ShellExecuteEx(lpVerb='runas', lpFile=sys.executable, lpParameters=params)
            sys.exit()
        return True
    except:
        return False
